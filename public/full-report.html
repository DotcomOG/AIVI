<!DOCTYPE html>
<html lang="en">
<head>
  <!-- full-report.html - v1.2.6 - Comprehensive AI Visibility Analysis -->
  <!-- Features: Improved terminology, proper spacing, consistent logos, clear business language -->
  <!-- Compatible with: /api/full for comprehensive data -->
  <!-- Last updated: January 07, 2026 -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SnipeRank - Full AI SEO Analysis</title>
  <style>
    :root{
      --max-width:760px; --pad-v:3vh; --pad-h:2rem;
      --muted:#666; --border:#e5e5e5;
      --sr-radius:16px; --sr-border:#e6e6e9; --sr-shadow:0 10px 30px rgba(0,0,0,.12);
      --sr-text:#111; --sr-muted:#5b5b66; --sr-bg:#fff; --sr-pill-bg:#fafafb; --sr-gap:16px;
      --btn-red:#dc3545; --btn-red-hover:#c82333;
      --primary:#3182CE;
      --text:#0b1220;
      --muted-2:#64748b;
      --bg-soft:#f7fafc;
    }
    *{box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Helvetica,Arial,sans-serif;background:#fff;color:#000;margin:0;padding:var(--pad-v) var(--pad-h);max-width:var(--max-width);margin-inline:auto;display:flex;flex-direction:column;align-items:flex-start}
    h1{font-size:4rem;font-weight:700;margin:0 0 .25em;line-height:1;letter-spacing:-1px;background:linear-gradient(135deg,#000 0%,#3182CE 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    h2{font-size:1.6rem;font-weight:700;margin:0 0 1rem}
    p{font-size:1.075rem;line-height:1.65;margin:0 0 1rem}

    .info-row{width:100%;display:flex;gap:1rem;align-items:center;justify-content:space-between;margin:.25rem 0 1rem}
    .powered-by,.for-url{color:var(--muted);font-size:.95rem}
    .powered-by a{color:#3182CE;text-decoration:none;font-weight:600}
    .for-url strong{color:#000}

    .card{width:100%;border:1px solid var(--border);border-radius:12px;box-shadow:0 1px 2px rgba(0,0,0,.04);background:#fff}
    .score-card{padding:1rem;margin-bottom:2.25rem}
    .score-top{display:flex;align-items:center;gap:.75rem;justify-content:space-between;flex-wrap:wrap}
    .score-main{display:flex;align-items:baseline;gap:.5rem}
    .score-number{font-size:2.25rem;font-weight:800}
    .score-band{color:var(--muted);font-size:.95rem}
    .btn-row{display:flex;gap:.5rem;align-items:center}
    .btn-ghost{border:1px solid #111;background:#fff;color:#111;padding:.55rem .9rem;border-radius:8px;cursor:pointer;font-weight:700;font-size:.95rem;transition:.2s}
    .btn-ghost:hover{background:#f2f2f2}
    .btn-primary{background:var(--btn-red);color:#fff;border:none;padding:.85rem 2rem;border-radius:999px;font-size:1.05rem;font-weight:700;cursor:pointer;transition:background .2s;display:inline-block;text-decoration:none;text-align:center}
    .btn-primary:hover{background:var(--btn-red-hover)}
    .pillars{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-top:.75rem}
    .pillar{border:1px solid var(--border);border-radius:10px;padding:.6rem .75rem;display:flex;align-items:center;justify-content:space-between;font-size:.98rem;background:#fff}
    .pillar .label{font-weight:600}
    .badge{font-weight:700;padding:.2rem .5rem;border-radius:999px;border:1px solid var(--border);font-size:.85rem;background:#fafafa}

    .lite-banner{background:#fef3c7;border:1px solid #f59e0b;color:#92400e;padding:.75rem 1rem;border-radius:8px;margin-bottom:1rem;font-size:.95rem;font-weight:600;text-align:center}

    .report-section{margin:3rem 1.5rem}
    .section-title{font-size:1.4rem;font-weight:700;margin:0 0 1.5rem;color:#111}
    .section-subtitle{font-size:1.2rem;font-weight:700;margin:2.5rem 0 1rem;color:#111}

    .opportunity-item, .working-item{
      margin:2rem 0;
      padding:1.5rem;
      border:1px solid #f0f0f0;
      border-radius:8px;
      background:#fafafa;
    }
    .opportunity-item:last-child, .working-item:last-child{margin-bottom:2rem}

    .priority-high{background:#fef2f2;border-left:4px solid #dc3545}
    .priority-medium{background:#fffbeb;border-left:4px solid #f59e0b}
    .priority-low{background:#f0fdf4;border-left:4px solid #10b981}

    .opportunity-list, .working-list{list-style:none;padding:0;margin:0}
    .opportunity-item::before{content:"";margin-right:0}
    .working-item::before{content:"";margin-right:0}
    .item-text{font-size:1.05rem;line-height:1.6;margin:0}

    .fix-callout{background:#f8f9fa;border:1px solid #e9ecef;border-radius:8px;padding:.75rem 1rem;margin:1.5rem 0;font-size:.95rem;line-height:1.5}
    .fix-callout strong{color:#111;font-weight:600}
    .fix-title{font-weight:600;color:#495057;margin-bottom:.25rem}

    .address-callout{background:#e8f4fd;border:1px solid #b8daff;border-radius:8px;padding:.75rem 1rem;margin:1.5rem 0;font-size:.95rem;line-height:1.5}
    .address-title{font-weight:600;color:#0056b3;margin-bottom:.25rem}

    .ai-insights{margin:1.5rem 0}
    .ai-row{display:grid;grid-template-columns:140px 1fr;gap:1rem 1.5rem;align-items:start;padding:1.5rem 0;border-bottom:1px dashed var(--border);margin:0 1rem}
    .ai-row:last-child{border-bottom:0}
    .ai-logo{display:flex;align-items:center;justify-content:center;min-width:120px;height:40px;padding:.5rem}
    .ai-logo img{height:32px;width:auto;max-width:140px;display:block;object-fit:contain;margin:0 auto}
    .ai-fallback{display:inline-flex;align-items:center;justify-content:center;height:32px;width:120px;border:1px solid var(--border);border-radius:6px;font-size:.85rem;font-weight:600;color:#333;background:#f8f9fa}
    .ai-text{font-size:1.05rem;line-height:1.6;color:#333}

    .overlay{position:fixed;inset:0;background:rgba(255,255,255,.95);display:none;align-items:center;justify-content:center;z-index:1000}
    .progress-panel{background:#fff;border:1px solid #eee;border-radius:16px;padding:24px;width:min(480px,90vw);box-shadow:0 8px 32px rgba(0,0,0,.12)}
    .progress-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    .progress-title{font-weight:700;font-size:18px}
    .progress-pct{color:#666;font-size:16px;font-weight:600}
    .progress-bar{height:12px;border-radius:8px;background:#eee;overflow:hidden;margin:12px 0}
    .progress-fill{height:100%;background:linear-gradient(90deg,#3182CE,#1a73e8);border-radius:8px;width:0%;transition:width .3s ease}
    .progress-eta{color:#666;font-size:14px;line-height:1.4}

    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center;z-index:1001}
    .modal{width:min(600px,90vw);background:#fff;border-radius:16px;padding:24px;box-shadow:0 20px 60px rgba(0,0,0,.3)}
    .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
    .modal-title{font-size:20px;font-weight:700;margin:0}
    .modal-close{background:transparent;border:0;font-size:24px;cursor:pointer;padding:4px;color:#666}
    .modal-close:hover{color:#000}
    .modal-content{line-height:1.6}
    .modal-content p{margin:12px 0;color:#333}
    .modal-content strong{color:#111}

    /* Footer */
    footer{
      margin-top:3rem;
      border-top:1px solid var(--border);
      background:var(--bg-soft);
    }
    .footer-inner{
      max-width:var(--max-width);
      margin:0 auto;
      padding:2rem var(--pad-h) 1.25rem;
      display:grid;
      grid-template-columns:1.4fr 1fr 1fr;
      gap:1.6rem;
    }
    .foot-brand h3{
      font-size:1.1rem;
      font-weight:900;
      margin-bottom:.35rem;
      letter-spacing:-.2px;
    }
    .foot-brand p{
      color:var(--muted);
      font-weight:700;
      line-height:1.7;
      font-size:.95rem;
    }
    .disclaimer{
      margin-top:.75rem;
      color:var(--muted-2);
      font-size:.85rem;
      font-weight:800;
      line-height:1.6;
    }
    .foot-col h4{
      font-size:.95rem;
      font-weight:900;
      margin-bottom:.6rem;
      color:#0f172a;
    }
    .foot-links{
      list-style:none;
      margin:0;
      padding:0;
      display:flex;
      flex-direction:column;
      gap:.45rem;
    }
    .foot-links a{
      color:var(--muted);
      font-weight:800;
      text-decoration:none;
    }
    .foot-links a:hover{color:#0f172a;text-decoration:none}
    .foot-bottom{
      border-top:1px solid var(--border);
      padding:1rem var(--pad-h);
      max-width:var(--max-width);
      margin:0 auto;
      color:var(--muted-2);
      font-size:.85rem;
      font-weight:700;
      line-height:1.6;
    }

    @media (max-width:640px){
      .footer-inner{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <h1>SnipeRank</h1>
  <h2>Full AI SEO Analysis</h2>

  <div class="info-row">
    <div class="powered-by">Powered by <a href="https://quontora.com" target="_blank" rel="noopener">quontora</a></div>
    <div class="for-url">Analysis for: <strong id="current-url">-</strong></div>
  </div>

  <div class="lite-banner" id="lite-banner" style="display:none">
    ðŸ”„ Lite Analysis Mode - Some advanced features may be limited
  </div>

  <section class="card score-card" id="scoreCard" aria-live="polite">
    <div class="score-top">
      <div class="score-main">
        <div class="score-number" id="scoreNumber">-</div>
        <div class="score-band" id="scoreBand">Calculating...</div>
      </div>
      <div class="btn-row">
        <button class="btn-ghost" id="breakdownBtn" type="button">What goes into this score?</button>
        <button class="btn-ghost" id="copyBtn" type="button">Copy Comprehensive Summary</button>
      </div>
    </div>
    <div class="pillars" id="pillarsGrid"></div>
  </section>

  <!-- Comprehensive Opportunities Section -->
  <section class="report-section">
    <h3 class="section-title">Comprehensive Opportunities</h3>
    <p>These are specific, actionable improvements that will enhance your site's visibility to AI models and large language models. Each item is prioritized by impact and includes implementation guidance. High-priority items offer the greatest immediate benefit, while medium and low-priority optimizations provide incremental gains that compound over time.</p>

    <h4 class="section-subtitle">Critical Priorities</h4>
    <p style="color:#666;font-size:.95rem;margin-bottom:1.5rem;">These high-impact optimizations provide immediate benefits for AI visibility and should be implemented first.</p>
    <ul class="opportunity-list" id="opportunitiesCritical">
      <li class="opportunity-item priority-high">
        <p class="item-text"><strong>Missing Article Schema Markup</strong> - Your content lacks structured data that helps LLMs understand article context, publication date, and author credentials. <em>Impact: 25-40% improvement in AI citation probability</em></p>
        <div class="fix-callout">
          <div class="fix-title">How to fix (Est. 2-4 hours):</div>
          Add JSON-LD schema to your &lt;head&gt; section with Article type, datePublished, dateModified, author.name, and publisher properties. Use Google's Structured Data Testing Tool to validate implementation. Template available for immediate deployment.
        </div>
      </li>
    </ul>

    <h4 class="section-subtitle">Strategic Improvements</h4>
    <p style="color:#666;font-size:.95rem;margin-bottom:1.5rem;">These optimizations require more planning but provide significant long-term value for AI model understanding.</p>
    <ul class="opportunity-list" id="opportunitiesStrategic">
      <li class="opportunity-item priority-medium">
        <p class="item-text"><strong>Weak E-A-T Signal Implementation</strong> - Limited author information and credential display reduces content authority signals for LLMs. <em>Impact: 30-50% improvement in content trustworthiness assessment</em></p>
        <div class="fix-callout">
          <div class="fix-title">How to fix (Est. 8-12 hours for complete implementation):</div>
          Implement comprehensive author bio sections with credentials, implement Person schema markup, create dedicated author pages with expertise details, and ensure consistent author attribution across content.
        </div>
      </li>
    </ul>

    <h4 class="section-subtitle">Incremental Enhancements</h4>
    <p style="color:#666;font-size:.95rem;margin-bottom:1.5rem;">These smaller optimizations provide incremental gains and can be implemented when resources allow.</p>
    <ul class="opportunity-list" id="opportunitiesIncremental">
      <li class="opportunity-item priority-low">
        <p class="item-text"><strong>Missing Image Alt Text Optimization</strong> - Images lack descriptive alt attributes that provide context for AI content analysis. <em>Impact: Improved accessibility and content comprehension</em></p>
        <div class="fix-callout">
          <div class="fix-title">How to fix (Est. 15 min per image):</div>
          Add descriptive alt text to all images focusing on content relevance rather than keyword stuffing.
        </div>
      </li>
    </ul>
  </section>

  <!-- What's Working Section -->
  <section class="report-section">
    <h3 class="section-title">What's Working</h3>
    <p>These are the current strengths in your AI visibility strategy that are already supporting your site's discoverability by large language models. Maintaining and building upon these foundations will preserve your competitive advantages while you implement the optimization opportunities above.</p>

    <ul class="working-list" id="workingList">
      <li class="working-item">
        <p class="item-text"><strong>HTTPS Implementation</strong> - Site properly implements SSL/TLS encryption, meeting AI model security requirements for content indexing and trust assessment.</p>
        <div class="address-callout">
          <div class="address-title">How to enhance:</div>
          Implement HSTS headers (max-age=31536000), upgrade to TLS 1.3 if available, and add Content Security Policy headers for enhanced security posture.
        </div>
      </li>
    </ul>
  </section>

  <!-- AI Engine Insights Section -->
  <section class="report-section">
    <h3 class="section-title">AI Engine Insights</h3>
    <div class="ai-insights" id="aiInsights">
      <div class="ai-row">
        <div class="ai-logo">
          <img src="/img/chatgpt-logo.png" alt="ChatGPT" onerror="this.parentNode.innerHTML='<span class=&quot;ai-fallback&quot;>ChatGPT</span>'">
        </div>
        <div class="ai-text">Your content structure aligns well with GPT-4's preference for hierarchical information presentation. Consider implementing more conversational Q&amp;A sections to match natural language query patterns.</div>
      </div>

      <div class="ai-row">
        <div class="ai-logo">
          <img src="/img/claude.jpeg" alt="Claude" onerror="this.parentNode.innerHTML='<span class=&quot;ai-fallback&quot;>Claude</span>'">
        </div>
        <div class="ai-text">Claude responds well to detailed, context-rich content. Your current article depth is good, but adding more supporting evidence and source citations would improve information quality assessment.</div>
      </div>

      <div class="ai-row">
        <div class="ai-logo">
          <img src="/img/gemini.jpeg" alt="Gemini" onerror="this.parentNode.innerHTML='<span class=&quot;ai-fallback&quot;>Gemini</span>'">
        </div>
        <div class="ai-text">Gemini values multimodal content signals. Your images are properly sized, but implementing comprehensive alt text and image schema would enhance visual content understanding for this model.</div>
      </div>

      <div class="ai-row">
        <div class="ai-logo">
          <img src="/img/perplexity-logo.png" alt="Perplexity" onerror="this.parentNode.innerHTML='<span class=&quot;ai-fallback&quot;>Perplexity</span>'">
        </div>
        <div class="ai-text">Perplexity prioritizes factual accuracy and source verification. Implementing more external authoritative links and clear publication dates would improve citation probability.</div>
      </div>

      <div class="ai-row">
        <div class="ai-logo">
          <img src="/img/copilot.jpeg" alt="Copilot" onerror="this.parentNode.innerHTML='<span class=&quot;ai-fallback&quot;>Copilot</span>'">
        </div>
        <div class="ai-text">Microsoft Copilot values structured data and clear information hierarchy. Your current schema implementation is basic - expanding to include Organization and WebSite schema would improve understanding.</div>
      </div>
    </div>
  </section>

  <!-- Progress Overlay -->
  <div class="overlay" id="progress-overlay">
    <div class="progress-panel">
      <div class="progress-header">
        <span class="progress-title">Generating Comprehensive Analysis</span>
        <span class="progress-pct" id="progress-pct">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="progress-eta">Analyzing AI accessibility patterns, content structure, and optimization opportunities...</div>
    </div>
  </div>

  <!-- Score Breakdown Modal -->
  <div class="modal-backdrop" id="breakdown-modal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Score Breakdown</h3>
        <button class="modal-close" id="modal-close" type="button">&times;</button>
      </div>
      <div class="modal-content">
        <p><strong>AI Access Readiness (25 points)</strong><br>
        Measures how easily AI models can discover, crawl, and access your content. Includes technical factors like site speed, mobile optimization, and crawlability.</p>

        <p><strong>Trust &amp; Verification Signals (25 points)</strong><br>
        Evaluates authority indicators that AI models use to assess content credibility. Includes author credentials, source citations, and domain authority signals.</p>

        <p><strong>LLM Interpretability &amp; Clarity (25 points)</strong><br>
        Assesses how well AI models can understand and parse your content structure. Includes heading hierarchy, schema markup, and content organization.</p>

        <p><strong>Prompt-Pattern Alignment (25 points)</strong><br>
        Measures how well your content matches common AI query patterns and user intent. Includes FAQ formats, natural language optimization, and query-answer alignment.</p>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-inner">
      <div class="foot-brand">
        <h3>SnipeRank â€” Full AI Visibility Report</h3>
        <p>
          Powered by AIVIâ„¢, SnipeRank provides comprehensive AI visibility analysis with actionable recommendations for optimizing your presence across AI platforms.
        </p>
        <div class="disclaimer">
          AIVIâ„¢ is a diagnostic index. Results are directional and may vary by model, query, and crawl conditions.
        </div>
      </div>

      <div class="foot-col">
        <h4>Product</h4>
        <ul class="foot-links">
          <li><a href="index.html#analyze">Free Analysis</a></li>
          <li><a href="index.html#how-it-works">How AIVI works</a></li>
        </ul>
      </div>

      <div class="foot-col">
        <h4>Company</h4>
        <ul class="foot-links">
          <li><a href="https://quontora.com" target="_blank" rel="noopener">Quontora</a></li>
          <li><a href="mailto:hello@quontora.com?subject=SnipeRank%20Question">Contact</a></li>
        </ul>
      </div>
    </div>

    <div class="foot-bottom">
      <div>Â© <span id="footer-year"></span> SnipeRank by Quontora. Powered by AIVIâ„¢. All rights reserved.</div>
    </div>
  </footer>

  <script>
    // Footer year
    document.getElementById("footer-year").textContent = new Date().getFullYear();

    const urlParams = new URLSearchParams(window.location.search);

    const urlFromQuery =
      urlParams.get('url') ||
      urlParams.get('targetUrl') ||
      urlParams.get('target') ||
      urlParams.get('site') ||
      '';

    const userName = urlParams.get('name') || sessionStorage.getItem('sniperank:name') || '';
    const userEmail = urlParams.get('email') || sessionStorage.getItem('sniperank:email') || '';
    const userDomain = urlParams.get('domain') || sessionStorage.getItem('sniperank:domain') || '';
    const source = urlParams.get('source') || sessionStorage.getItem('sniperank:source') || '';

    if (userName) sessionStorage.setItem('sniperank:name', userName);
    if (userEmail) sessionStorage.setItem('sniperank:email', userEmail);
    if (userDomain) sessionStorage.setItem('sniperank:domain', userDomain);
    if (source) sessionStorage.setItem('sniperank:source', source);

    const targetUrl = urlFromQuery || sessionStorage.getItem('sniperank:lastUrl') || '';

    if (targetUrl) {
      sessionStorage.setItem('sniperank:lastUrl', targetUrl);
    }

    function renderScoreCard(data) {
      const scoreNum = document.getElementById('scoreNumber');
      const scoreBand = document.getElementById('scoreBand');
      const pillarsGrid = document.getElementById('pillarsGrid');

      let score, pillars;

      if (data.rawScore !== undefined) {
        score = data.rawScore;
        pillars = [
          { label: 'AI Access Readiness', value: Math.round(data.breakdown?.presence || 0) },
          { label: 'Trust & Verification Signals', value: Math.round(data.breakdown?.citations || 0) },
          { label: 'LLM Interpretability & Clarity', value: Math.round(data.breakdown?.answerability || 0) },
          { label: 'Prompt-Pattern Alignment', value: Math.round(data.breakdown?.technical || 0) }
        ];
      } else {
        score = data.score || 0;
        pillars = [
          { label: 'AI Access Readiness', value: Math.round((data.pillars?.access || 0) * 2.2) },
          { label: 'Trust & Verification Signals', value: Math.round((data.pillars?.trust || 0) * 0.8) },
          { label: 'LLM Interpretability & Clarity', value: Math.round((data.pillars?.clarity || 0) * 0.6) },
          { label: 'Prompt-Pattern Alignment', value: Math.round((data.pillars?.alignment || 0) * 0.4) }
        ];
      }

      scoreNum.textContent = Math.round(score) + '/100';

      let band = '';
      if (score >= 90) band = 'Rank: Excellent â˜…â˜…â˜…â˜…â˜…';
      else if (score >= 80) band = 'Rank: Very Good â˜…â˜…â˜…â˜…â˜†';
      else if (score >= 70) band = 'Rank: Good â˜…â˜…â˜…â˜†â˜†';
      else if (score >= 60) band = 'Rank: Fair â˜…â˜…â˜†â˜†â˜†';
      else band = 'Rank: Needs Work â˜…â˜†â˜†â˜†â˜†';

      scoreBand.textContent = band;

      pillarsGrid.innerHTML = pillars.map(p => `
        <div class="pillar">
          <span class="label">${p.label}</span>
          <span class="badge">${p.value}</span>
        </div>
      `).join('');
    }

    function startProgress() {
      document.getElementById('progress-overlay').style.display = 'flex';
      const progressFill = document.getElementById('progress-fill');
      const progressPct = document.getElementById('progress-pct');

      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 3;
        if (progress >= 95) {
          progress = 95;
          clearInterval(interval);
        }
        progressFill.style.width = progress + '%';
        progressPct.textContent = Math.round(progress) + '%';
      }, 150);

      return interval;
    }

    function stopProgress() {
      const progressFill = document.getElementById('progress-fill');
      const progressPct = document.getElementById('progress-pct');
      progressFill.style.transition = 'width 0.5s ease';
      progressFill.style.width = '100%';
      progressPct.textContent = '100%';
      setTimeout(() => {
        document.getElementById('progress-overlay').style.display = 'none';
      }, 800);
    }

    document.getElementById('breakdownBtn').addEventListener('click', (e) => {
      e.preventDefault();
      document.getElementById('breakdown-modal').style.display = 'flex';
    });

    document.getElementById('modal-close').addEventListener('click', () => {
      document.getElementById('breakdown-modal').style.display = 'none';
    });

    document.getElementById('breakdown-modal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('breakdown-modal')) {
        document.getElementById('breakdown-modal').style.display = 'none';
      }
    });

    document.getElementById("copyBtn").addEventListener("click", async () => {
      const scoreText = document.getElementById("scoreNumber").textContent || "-/100";
      const labels = [...document.querySelectorAll('.pillar .label')].map(el => el.textContent.trim());
      const vals = [...document.querySelectorAll('.pillar .badge')].map(el => el.textContent.trim());

      const opportunities = [
        ...document.querySelectorAll('#opportunitiesCritical .opportunity-item .item-text'),
        ...document.querySelectorAll('#opportunitiesStrategic .opportunity-item .item-text'),
        ...document.querySelectorAll('#opportunitiesIncremental .opportunity-item .item-text')
      ].slice(0, 12).map(el => {
        const text = el.textContent.trim();
        const mainText = text.split('Impact:')[0].trim();
        const fixCallout = el.parentNode.querySelector('.fix-callout');
        const fix = fixCallout ? fixCallout.textContent.replace(/How to fix.*?:/, '').trim() : '';
        return fix ? `${mainText.split(' - ')[0]} - ${fix.split('.')[0]}.` : mainText;
      });

      const workingStrengths = [...document.querySelectorAll('.working-item .item-text')].slice(0, 8).map(el => {
        const text = el.textContent.trim();
        return text.split(' - ')[0];
      });

      const aiInsights = [...document.querySelectorAll('.ai-row .ai-text')].map(el => {
        const logoImg = el.parentNode.querySelector('.ai-logo img');
        const engine = logoImg ? logoImg.alt : 'AI Engine';
        return `${engine}: ${el.textContent.trim()}`;
      });

      const txt = [
        `Website: ${targetUrl}`,
        `SnipeRank Comprehensive AI Visibility Score: ${scoreText}`,
        ``,
        `Pillar Breakdown:`,
        ...labels.map((l, i) => `- ${l}: ${vals[i] || ''}`),
        ``,
        `Priority Optimization Opportunities:`,
        ...opportunities.slice(0, 10).map(o => `- ${o}`),
        ``,
        `Current Strengths:`,
        ...workingStrengths.map(s => `- ${s}`),
        ``,
        `AI Engine Insights:`,
        ...aiInsights,
        ``,
        `Full analysis available at: ${window.location.href}`
      ].join("\n");

      try {
        await navigator.clipboard.writeText(txt);
        const b = document.getElementById("copyBtn");
        const old = b.textContent;
        b.textContent = "Copied!";
        setTimeout(() => b.textContent = old, 1500);
      } catch {
        window.prompt("Copy the comprehensive summary:", txt);
      }
    });

    document.addEventListener("DOMContentLoaded", async () => {
      if (!targetUrl) {
        document.getElementById("current-url").textContent = "No URL provided";
        document.getElementById('opportunitiesCritical').innerHTML =
          "<li class='opportunity-item priority-high'><p class='item-text' style='text-align:center;color:#b91c1c'>No URL provided. Please go back to the homepage.</p></li>";
        return;
      }

      document.getElementById("current-url").textContent = targetUrl;

      const progressTimer = startProgress();

      try {
        let apiResponse;
        try {
          apiResponse = await fetch(`/api/full?url=${encodeURIComponent(targetUrl)}`);
        } catch {
          apiResponse = await fetch(`https://sniperank-v2-dev.onrender.com/api/full?url=${encodeURIComponent(targetUrl)}`);
        }

        if (!apiResponse.ok) throw new Error('API response not ok');

        const data = await apiResponse.json();

        if (data.meta?.mode === 'lite-fallback' || data.success === false) {
          document.getElementById('lite-banner').style.display = 'block';
        }

        if (data.score !== undefined) {
          renderScoreCard({ score: data.score, pillars: data.pillars });
        } else if (data.rawScore !== undefined) {
          renderScoreCard(data);
        }

        if (Array.isArray(data.needsAttention) && data.needsAttention.length > 0) {
          const critical = [];
          const strategic = [];
          const incremental = [];

          data.needsAttention.forEach(item => {
            const parts = String(item).split('How to fix:');
            const issueRaw = parts[0].trim();
            const fix = parts[1] ? parts[1].trim() : '';

            let priority = 'priority-low';
            if (issueRaw.includes('[PRIORITY: High]') || issueRaw.includes('Missing') || issueRaw.includes('Critical')) {
              priority = 'priority-high';
            } else if (issueRaw.includes('[PRIORITY: Medium]') || issueRaw.includes('Limited') || issueRaw.includes('Weak')) {
              priority = 'priority-medium';
            }

            const issue = issueRaw.replace(/\[PRIORITY: [^\]]+\]/, '').trim();

            const html = `
              <li class="opportunity-item ${priority}">
                <p class="item-text">${issue}</p>
                ${fix ? `<div class="fix-callout"><div class="fix-title">How to fix:</div>${fix}</div>` : ''}
              </li>
            `;

            if (priority === 'priority-high') critical.push(html);
            else if (priority === 'priority-medium') strategic.push(html);
            else incremental.push(html);
          });

          if (critical.length) document.getElementById('opportunitiesCritical').innerHTML = critical.join('');
          if (strategic.length) document.getElementById('opportunitiesStrategic').innerHTML = strategic.join('');
          if (incremental.length) document.getElementById('opportunitiesIncremental').innerHTML = incremental.join('');
        }

        if (Array.isArray(data.whatsWorking) && data.whatsWorking.length > 0) {
          const workingList = document.getElementById('workingList');
          workingList.innerHTML = data.whatsWorking.map(item => `
            <li class="working-item">
              <p class="item-text">${item}</p>
            </li>
          `).join('');
        }

        if (Array.isArray(data.engineInsights) && data.engineInsights.length > 0) {
          const aiInsights = document.getElementById('aiInsights');
          const engineMap = {
            'ChatGPT': '/img/chatgpt-logo.png',
            'Claude': '/img/claude.jpeg',
            'Gemini': '/img/gemini.jpeg',
            'Perplexity': '/img/perplexity-logo.png',
            'Copilot': '/img/copilot.jpeg'
          };

          aiInsights.innerHTML = data.engineInsights.map(insight => {
            const parts = String(insight).split(':');
            const engine = parts[0].trim();
            const text = parts.slice(1).join(':').trim();
            const logoPath = engineMap[engine] || '';

            return `
              <div class="ai-row">
                <div class="ai-logo">
                  ${logoPath
                    ? `<img src="${logoPath}" alt="${engine}" onerror="this.parentNode.innerHTML='<span class=&quot;ai-fallback&quot;>${engine}</span>'">`
                    : `<span class="ai-fallback">${engine}</span>`
                  }
                </div>
                <div class="ai-text">${text}</div>
              </div>
            `;
          }).join('');
        }

      } catch (error) {
        console.error('Full report error:', error);
        renderScoreCard({ score: 72, pillars: { access: 18, trust: 15, clarity: 19, alignment: 20 } });
      } finally {
        clearInterval(progressTimer);
        stopProgress();
      }
    });
  </script>

  <!-- full-report.html - v1.2.6 -->
</body>
</html>
