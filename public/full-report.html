<!DOCTYPE html>
<!--
  full-report.html
  Version: v2026.01.16-2
  Last updated: 2026-01-16
-->
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AIVIndex™ – Full AI Visibility Report</title>

  <!-- Uses your existing stylesheet -->
  <link rel="stylesheet" href="styles.css" />

  <style>
    /* Minimal safety styles only (won't fight your CSS) */
    .sr-wrap { max-width: 960px; margin: 0 auto; padding: 28px 20px 60px; }
    .sr-top { display: flex; justify-content: space-between; gap: 18px; flex-wrap: wrap; align-items: baseline; }
    .sr-brand h1 { margin: 0; font-size: 48px; letter-spacing: -0.02em; }
    .sr-brand h2 { margin: 6px 0 0; font-size: 22px; font-weight: 600; }
    .sr-meta { margin-top: 10px; font-size: 14px; opacity: 0.8; }
    .sr-chip { display: inline-flex; gap: 10px; align-items: center; padding: 10px 12px; border-radius: 12px; border: 1px solid rgba(0,0,0,0.12); background: rgba(0,0,0,0.03); }
    .sr-intro { margin-top: 22px; padding: 16px 18px; border-radius: 16px; border: 1px solid rgba(0,0,0,0.12); background: #fff; }
    .sr-intro h3 { margin: 0 0 8px; font-size: 16px; }
    .sr-intro p { margin: 0; line-height: 1.5; opacity: 0.9; }
    .sr-section { margin-top: 28px; }
    .sr-section h3 { margin: 0 0 10px; font-size: 22px; }
    .sr-section .sub { margin: 0 0 18px; opacity: 0.85; line-height: 1.5; }
    .sr-box { border: 1px solid rgba(0,0,0,0.12); border-radius: 16px; background: #fff; overflow: hidden; }
    .sr-item { padding: 14px 16px; border-top: 1px solid rgba(0,0,0,0.08); }
    .sr-item:first-child { border-top: none; }
    .sr-item .t { font-weight: 700; margin: 0 0 6px; }
    .sr-item .i { margin: 0; opacity: 0.9; }
    .sr-item .g { margin-top: 10px; padding: 12px; border-radius: 12px; background: rgba(0,0,0,0.03); border: 1px solid rgba(0,0,0,0.08); }
    .sr-item .g .k { font-weight: 700; margin: 0 0 6px; }
    .sr-item .g p { margin: 0; opacity: 0.9; }
    .sr-error { margin-top: 18px; padding: 12px 14px; border-radius: 14px; border: 1px solid rgba(180,0,0,0.25); background: rgba(180,0,0,0.06); }
    .sr-error strong { display: block; margin-bottom: 6px; }
    .sr-foot { margin-top: 44px; padding-top: 18px; border-top: 1px solid rgba(0,0,0,0.08); font-size: 13px; opacity: 0.75; }
    .sr-link { color: inherit; text-decoration: underline; }
  </style>
</head>

<body>
  <main class="sr-wrap">
    <div class="sr-top">
      <div class="sr-brand">
        <h1>AIVIndex™</h1>
        <h2>Full AI Visibility Report</h2>
        <div class="sr-meta">
          Powered by <a class="sr-link" href="https://quontora.com" target="_blank" rel="noopener">Quontora</a>
        </div>
      </div>

      <div class="sr-chip" id="srTargetChip" aria-live="polite">
        <div><strong>Analysis for:</strong> <span id="srTarget">—</span></div>
      </div>
    </div>

    <!-- TOP: scorecard removed; replaced with text -->
    <section class="sr-intro">
      <h3>How AI currently interprets this site</h3>
      <p>
        This report evaluates how AI systems access, interpret, and represent this website. The focus is AI visibility:
        clarity of meaning, trust signals, structural readability, and alignment with the patterns AI relies on when generating answers.
        The findings below highlight where interpretation is strong, where it is ambiguous, and where critical signals are missing or degraded.
      </p>
    </section>

    <section class="sr-section" id="srOps">
      <h3>Comprehensive Opportunities</h3>
      <p class="sub">
        Specific, actionable improvements to strengthen how AI systems interpret, trust, and represent your website. Items are grouped by urgency.
      </p>

      <div class="sr-box" id="srOpsBox">
        <div class="sr-item">
          <p class="t">Loading…</p>
          <p class="i">Fetching analysis from the API.</p>
        </div>
      </div>

      <div class="sr-error" id="srErr" style="display:none;">
        <strong>Analysis unavailable.</strong>
        <div id="srErrMsg">—</div>
      </div>
    </section>

    <div class="sr-foot">
      If this looks incomplete, it usually means the full analysis endpoint did not return data. This page calls <code>/api/full</code> directly.
    </div>
  </main>

  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const targetUrl = params.get("url") || "";
      const targetEl = document.getElementById("srTarget");
      const opsBox = document.getElementById("srOpsBox");
      const errBox = document.getElementById("srErr");
      const errMsg = document.getElementById("srErrMsg");

      targetEl.textContent = targetUrl ? targetUrl : "—";

      function safeText(v) {
        if (v === null || v === undefined) return "";
        return String(v);
      }

      function renderOpportunities(groups) {
        // groups expected as: [{ title: "Critical Priorities", items: [...] }, ...]
        const nodes = [];
        (groups || []).forEach(group => {
          const gTitle = safeText(group.title || "");
          const items = Array.isArray(group.items) ? group.items : [];
          if (!gTitle && items.length === 0) return;

          const header = document.createElement("div");
          header.className = "sr-item";
          header.innerHTML = `<p class="t">${gTitle || "Opportunities"}</p>`;
          nodes.push(header);

          items.forEach(it => {
            const title = safeText(it.title || it.name || "Opportunity");
            const impact = safeText(it.impact || "");
            const guidance = safeText(it.guidance || it.implementation || it.implementation_guidance || "");

            const row = document.createElement("div");
            row.className = "sr-item";
            row.innerHTML = `
              <p class="t">${title}</p>
              ${impact ? `<p class="i"><strong>Impact:</strong> ${impact}</p>` : `<p class="i"></p>`}
              ${guidance ? `
                <div class="g">
                  <p class="k">Implementation guidance</p>
                  <p>${guidance}</p>
                </div>` : ``}
            `;
            nodes.push(row);
          });
        });

        if (nodes.length === 0) {
          opsBox.inner


          <!-- =========================
       FULL-REPORT.HTML (PART 2)
       Continue from where I stopped
       ========================= -->

  <!-- REST OF PAGE CONTINUES UNCHANGED -->
  <section id="opportunities">
    <!-- existing content -->
  </section>

  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      const targetUrl = params.get("url");

      // If no URL provided, fail fast (but cleanly).
      if (!targetUrl) {
        console.error("Missing ?url= parameter");
        return;
      }

      // IMPORTANT FIX: call Vercel API routes under /api/*
      const fullEndpoint = `/api/full?url=${encodeURIComponent(targetUrl)}`;
      const scoreEndpoint = `/api/score?url=${encodeURIComponent(targetUrl)}`;

      // Optional: expose data for any existing render code that expects it.
      window.__AIVI__ = window.__AIVI__ || {};
      window.__AIVI__.targetUrl = targetUrl;

      // Helper: emit an event so existing code can hook in without refactors.
      function emit(name, detail) {
        try {
          window.dispatchEvent(new CustomEvent(name, { detail }));
        } catch (e) {
          // older browsers
        }
      }

      // Fetch score + full in parallel (if your current page uses both).
      Promise.allSettled([
        fetch(scoreEndpoint, { cache: "no-store" }).then(r => r.ok ? r.json() : Promise.reject(new Error(`score HTTP ${r.status}`))),
        fetch(fullEndpoint, { cache: "no-store" }).then(r => r.ok ? r.json() : Promise.reject(new Error(`full HTTP ${r.status}`)))
      ]).then(results => {
        const scoreRes = results[0];
        const fullRes = results[1];

        if (scoreRes.status === "fulfilled") {
          window.__AIVI__.score = scoreRes.value;
          emit("aivi:score", scoreRes.value);
        } else {
          console.warn("Score fetch failed:", scoreRes.reason);
          emit("aivi:score:error", { error: String(scoreRes.reason || "unknown") });
        }

        if (fullRes.status === "fulfilled") {
          window.__AIVI__.full = fullRes.value;
          emit("aivi:full", fullRes.value);
        } else {
          console.warn("Full fetch failed:", fullRes.reason);
          emit("aivi:full:error", { error: String(fullRes.reason || "unknown") });
        }
      }).catch(err => {
        console.error("Unexpected fetch failure:", err);
      });
    })();
  </script>

</body>
</html>

<!-- Version: v2026.01.16-1 -->
